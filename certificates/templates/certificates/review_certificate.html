{% extends "base.html" %}
{% block content %}
<div class="max-w-3xl mx-auto bg-white shadow rounded-xl p-6">
  <h2 class="text-2xl font-bold mb-4">Certificate Request Details</h2>

  <div class="space-y-2 text-gray-800">
    <p><b>Request ID:</b> {{ req.request_code }}</p>
    <p><b>Student:</b> {{ req.student.get_full_name|default:req.student.username }} ({{ req.student.username }})</p>
    <p><b>Certificate Type:</b> {{ req.get_cert_type_display }}</p>
    <p><b>Purpose:</b> {{ req.purpose|default:"â€”" }}</p>
    <p><b>Status:</b> {{ req.status|upper }}</p>
    <p><b>Created At:</b> {{ req.created_at }}</p>
  </div>

  <hr class="my-4">

  <h3 class="text-lg font-semibold mb-2">Attachments</h3>
  {% if attachments %}
    <ul class="list-disc pl-6">
      {% for a in attachments %}
        <li>
          <a class="text-indigo-600 underline" href="{{ a.file.url }}" target="_blank">
            {{ a.file.name }}
          </a>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p class="text-gray-500">No attachments uploaded.</p>
  {% endif %}

  <div class="mt-6 flex gap-2">
    <a href="{% url 'approve_certificate_request' req.id %}"
       class="px-4 py-2 bg-green-600 text-white rounded">Approve</a>

    <a href="{% url 'reject_certificate_request' req.id %}"
       class="px-4 py-2 bg-red-600 text-white rounded">Reject</a>

    {% if request.user.userprofile.role|lower == "dean" %}
      <a href="{% url 'forward_certificate_to_principal' req.id %}"
         class="px-4 py-2 bg-yellow-600 text-white rounded">Forward to Principal</a>
    {% endif %}
  </div>
</div>
{% endblock %}
