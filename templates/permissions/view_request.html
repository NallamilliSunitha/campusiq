{% extends 'base.html' %}

{% block content %}
<div class="max-w-2xl mx-auto bg-white shadow rounded p-6">

    <h2 class="text-xl font-bold mb-4">Permission Request</h2>

    <p><strong>Title:</strong> {{ req.title }}</p>
    <p><strong>Requested By:</strong> {{ req.student.username }}</p>
    <p><strong>From:</strong> {{ req.from_date }}</p>
    <p><strong>To:</strong> {{ req.to_date }}</p>
    <p><strong>Status:</strong> {{ req.status|capfirst }}</p>
    <p><strong>Request ID:</strong> {{ req.request_code }}</p>

    <hr class="my-4">

    <p class="font-semibold mb-2">Reason / Letter</p>

    {# ================= FILE CASE ================= #}
    {% if req.file and req.file.name %}
        <p class="text-sm text-gray-600">
            Uploaded file:
            <span class="font-medium">{{ req.file.name|cut:"permissions/" }}</span>
        </p>

        <div class="mt-3">
            <a href="{{ req.file.url }}"
               target="_blank"
               class="inline-block px-4 py-2 text-sm rounded bg-indigo-600 text-white hover:bg-indigo-700">
                üìÑ Open Uploaded File
            </a>
        </div>

    {# ================= AUTO LETTER CASE ================= #}
    {% else %}
        <div class="mt-3">
            <pre class="text-gray-700 whitespace-pre-wrap bg-gray-50 border rounded p-4">
{{ req.reason }}
            </pre>
        </div>
    {% endif %}

    <div class="mt-6">
        <a href="{% url 'dashboard' %}"
           class="inline-block text-blue-600 hover:underline">
            ‚Üê Back to Dashboard
        </a>
    </div>

</div>
{% endblock %}
